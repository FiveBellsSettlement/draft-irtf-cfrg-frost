---
title: "Two-Round FROST with Trusted Dealer"
abbrev: "FROST"
docname: draft-irtf-cfrg-frost-00
category: info

ipr: trust200902
area: General
workgroup: CFRG
keyword: Internet-Draft

stand_alone: yes
smart_quotes: no
pi: [toc, sortrefs, symrefs]

author:
 -  ins: C. Komlo
    name: Chelsea Komlo
    organization: University of Waterloo, Zcash Foundation
    email: ckomlo@uwaterloo.ca
 -  ins: I. Goldberg
    name: Ian Goldberg
    organization: University of Waterloo
    email: iang@uwaterloo.ca
 -  ins: D. Connelly
    name: Deirdre Connelly
    organization: Zcash Foundation
    email: durumcrustulum@gmail.com
 -  ins: T. Wilson-Brown
    name: T Wilson-Brown
    organization: Zcash Foundation
    email: teor@riseup.net

informative:
  frost:
    target: https://eprint.iacr.org/2020/852.pdf
    title: "Two-Round FROST with Trusted Dealer"
    author:
      - name: Chelsea Komlo
      - name: Ian Goldberg
      - name: Deirdre Connelly
      - name: T Wilson-Brown
    date: 2021-06-01



--- abstract

In this draft, we present a variant of FROST, a Flexible Round-Optimized Schnorr Threshold
signature scheme. FROST signatures can be issued after a threshold number of entities
cooperate to issue a signature, allowing for improved distribution of trust and
redundancy with respect to a secret key.
This variant of FROST specifically defines key generation as performed by a trusted dealer
and signing as a two-round protocol.
Finally, this draft specifies signatures that are compatible with EdDSA verification of
signatures. However, this draft does not generate deterministic nonces as defined by EdDSA,
to ensure protection against a key-recovery attack that is possible when even only one
participant is malicious.


--- middle

# Introduction

DISCLAIMER: This is a work-in-progress draft of FROST.

RFC EDITOR: PLEASE REMOVE THE FOLLOWING PARAGRAPH The source for this draft is
maintained in GitHub. Suggested changes should be submitted as pull requests
at https://github.com/chelseakomlo/frost-spec. Instructions are on that page as
well.

Unlike signatures in a single-party setting, threshold signatures
require cooperation among a threshold number of signers each holding a share
of a common private key.  The security of threshold schemes in general assume
that an adversary can corrupt strictly fewer than a threshold number of participants.

In this draft, we present a variant of FROST, a Flexible Round-Optimized Schnorr Threshold
signature scheme. FROST reduces network overhead during threshold signing operations while
employing a novel technique to protect against forgery attacks applicable to prior
Schnorr-based threshold signature constructions.

This draft specifies the variant of FROST that requires a trusted dealer to perform
key generation. Further, this draft specifies only two-round signing operations.
This draft specifies signatures that are compatible with EdDSA verification of
signatures, bui not EdDSA nonce generation. EdDSA-style nonce-generation, where the
nonce is derived deterministically, is insecure in a multi-party signature setting.

# Change Log

draft-01

- Submitted a draft that specifies notation and cryptographic dependencies,
as well including additional authors.

draft-00

- Submitted a basic draft after adoption of draft-komlo-frost as a working
  group item.

# Terminology

The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
"OPTIONAL" in this document are to be interpreted as described in
BCP 14 {{!RFC2119}} {{!RFC8174}} when, and only when, they appear in all
capitals, as shown here.

# Basic Assumptions

We maintain the following assumptions.

* Selection of participants. We assume implementations determine how participants
are selected for key generation and signing.
* Handling failures. We do not specify how implementations should handle failures.
* Sampling of secrets. We assume that secrets are sampled uniformly at random.

# Security Considerations

* Trusted dealer. The dealer that performs key generation is trusted to follow
the protocol, although participants still are able to verify the consistency of their
shares via a VSS (verifiable secret sharing) step.
* Unforgeability assuming less than `(t-1)` corrupted signers. So long as an adverary
corrupts fewer than `t-1` participants, the scheme remains secure against EUF-CMA attacks.
* Protection against key-recovery attacks. Nonces generated by each participant in the
first round of signing must be sampled uniformly at random and cannot be derived from some
determinstic function. This is to avoid replay attacks initiated by other signers, which
allows for a complete key-recovery attack.

## Communication channels

* Key Generation. At the time of key generation, we assume an authenticated, confidential, and
reliable channel. Specifically, the dealer must be able to transmit secret key material to each
participant over this channel.
* Signing. At the time of signing, we assume a reliable channel. While messages that are exchanged
contain no secret information, the channel must be able to deliver messages reliably in order for
the protocol to complete.

## Protocol Failures

We do not specify what implementations should do when the protocol fails, other than requiring that
the protocol abort. Examples of viable failure include when a verification check returns invalid or
if the underlying transport failed to deliver the required messages.

# Notation

The following notation and terminology are used throughout this document.

* `s` denotes a secret that is Shamir secret shared among the participants.
* `s_i` denotes the ith share of the secret `s`.
* A participant is an entity that is trusted to hold a secret share.
* `n` denotes the number of participants, and the number of shares that `s` is split into.
* `t` denotes the threshold number of participants required to issue a signature. More specifically,
at least `t` shares must be combined to issue a valid signature.
* `C` represents the coalition of signers, and is a set of participant identifiers of size at least `t`.
* `L_i` represents the ith Lagrange coefficient.
* `sig = (R, z)` denotes a Schnorr signature with public commitment `R` and response `z`.
* `PK` is the group public key.
* `sk_i` is each ith individual's private key.


# Cryptographic Dependencies

Help writing this section would be wonderful

FROST variants rely on the following primitives.

## Group operations

We require the following group operations defined by a prime-order group based on an elliptic curve:

TODO

## EdDSA Verification

  - `"Verify(PK, sig)"` outputs accept or fail

## Polynomial Operations

(Dan Shumow will write this section)

  * Evaluation of a polynomial at a specific point

    - Horner's method

  * Derivation of the ith Lagrange coefficient


## Shamir Secret Sharing

TODO finish the math after Dan writes the above section

In Shamir secret sharing, a
dealer distributes a secret `s` to `n` participants in such a way that any
cooperating subset of
`t` participants can recover the secret.
To distribute this secret, the dealer first
selects `t-1` coefficients `a_1, \dots, a_{t-1}`
at random,
and uses the randomly selected values as coefficients to define a
polynomial `f(x) = s + a_1 x + ... + a_t-1 x^t-1` of degree `t-1` where `f(0) = s`.

TODO figure out how to describe these sums


The secret shares for each
participant `P_i` are `(i, f(i))`, which the dealer is trusted to
distribute honestly to each participant.
To reconstruct the secret, at least `t` participants perform Lagrange
interpolation to reconstruct the polynomial and thus find the value `s=f(0)`.
However, no group of fewer than `t` participants can reconstruct the secret, as at least `t`
points are required to reconstruct a polynomial of degree `t-1`.

TODO describe the actual math to do this

## Verifiable Secret Sharing

Feldman's Verifiable Secret Sharing (VSS)
builds upon Shamir secret sharing, adding a verification step to
demonstrate the consistency of a participant's share with a public
commitment which all participants are assumed to hold a consistent view of.
To validate that a share is well formed,
each
participant validates their share using this commitment.
If the validation
fails, the participant can issue a complaint against the dealer, and
take actions such as broadcasting this complaint to all other participants.

TODO describe the math

# Two-Round FROST with Trusted Dealer

## Trusted Dealer Key Generation

To perform key generation, the dealer will simply employ Verifiable Secret Sharing
as a subroutine, providing as input a secret `s` that was generated uniformly at random.
The group's joint public key will simply be `PK = g^s`. Each participant's secret key
will simply be  `sk_i = s_i`, the secret share sent to them by the dealer.

TODO is this enough or do we need more here?

## Signing

Chelsea will write this

# Curve and Verification Compatability

Deirdre will write this.

* EdDSA over edwards25519 (RFC 8032)

* EdDSA over Ristretto

# Serialization and Message Format

Teor will write this.

# Security Considerations

##  External Requirements / Non-Goals

FROST does not target the following goals.

* Post quantum security. FROST requires the hardness of the Discrete Logarithm Problem.
* Robustness. In the case of failure, FROST requires aborting the protocol.
* Downgrade prevention. The sender and receiver are assumed to agree on what algorithms
to use.
* Metadata protection. If protection for metadata is desired, a higher-level communication
channel can be used to facilitate key generation and signing.


--- back

# Acknowledgments
{:numbered="false"}

TODO acknowledge.
